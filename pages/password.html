<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../style/password.css">
  <link rel="stylesheet" href="../style/login.css">
  <title>Mot de passe - RetailCoop</title>
</head>

<body>
  <div>
    <a href="search.html">bypass</a>
  </div>
  <div class="login-container">
    <div class="login-header">
      <h2>Connexion</h2>
    </div>
    <div class="login-box">
      <form id="passwordForm">
        <div class="input-group">
          <label for="password">Mot de passe</label>
          <input type="password" id="password" name="password" placeholder="Mot de passe">
        </div>
        <div class="form-footer">
          <a href='login.html'><button type="button" id="cancelButton">Annuler</button></a>
          <button type="submit" id="submitButton">Oui</button>
        </div>

      </form>
    </div>
    
  </div>
  
  

  <script>

    document.addEventListener('DOMContentLoaded', () => {
      
        cancelButton.addEventListener('cancelButton', function (event) {
          event.preventDefault();
          // Logique pour gérer l'annulation ici, par exemple retour à la page de connexion
          sessionStorage.clear();
          window.location.href = 'login.html';
        });
      
        submitButton.addEventListener('submit', function (event) {
          event.preventDefault();
          //console.log('Login:', loginValue);

          fetch('login.json')
              .then(function (response) {
                  return response.json();
              })
              .then(function (data) {
                  appendData(data);
              })
              .catch(function (err) {
                  console.log('error: ' + err);
              });

              function appendData(data) {
                var mainContainer = document.getElementById("password");
                
              }

              // Fonction pour vérifier si le login et le mot de passe correspondent à un utilisateur
              function checkLoginAndPassword(loginValue, password) {
                  for (var i = 0; i < data.length; i++) {
                      if (data[i].email === sessionStorage.getItem('loginValue') && data[i].password.toString() === passwordValue) {
                          return true; // Correspondance trouvée
                          window.location.href = 'search.html';
                      }
                  }
                  return false; // Aucune correspondance trouvée
              }

              // Utilisation de la fonction
              if (checkLoginAndPassword(loginValue, passwordValue)) {
                  console.log("Login et mot de passe valides");
                  // Faire quelque chose après la validation (par exemple, rediriger vers une autre page)
              } else {
                  console.log("Login ou mot de passe incorrect");
                  // Afficher un message d'erreur ou prendre d'autres mesures en conséquence
              }

        });
      });
      

  </script>
</body>
</html>
